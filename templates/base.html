{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}LigaPass{% endblock %}</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, #e2e8f0 100%);
      color: #1e293b;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* --- Footer --- */
    footer {
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(12px);
      border-top: 1px solid rgba(226, 232, 240, 0.6);
      color: #334155;
      font-size: 0.9rem;
    }

    /* --- Toast --- */
    #toast-container {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: flex-end;
    }

    .toast {
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: white;
      font-size: 0.875rem;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.5s ease-in-out;
      box-shadow: 0 4px 6px rgba(0,0,0,0.15);
    }
    .toast.show { opacity: 1; transform: translateX(0); }
    .toast.success { background-color: #16a34a; }
    .toast.error { background-color: #dc2626; }
    .toast.info { background-color: #2563eb; }
    .toast.warning { background-color: #f59e0b; }
    
    #confirm-modal {
      z-index: 100;
    }
  </style>

  {% block extra_head %}{% endblock %}
</head>

<body>
  {% include 'navbar.html' %}
  <div id="toast-container"></div>

  <main class="flex-grow container mx-auto px-6 py-10">
    {% block content %}
      <div class="text-center text-slate-600">
        <h2 class="text-2xl font-semibold mb-4">Welcome to LigaPass ⚽</h2>
        <p>Where football passion meets technology.</p>
      </div>
    {% endblock %}
  </main>

  <div id="confirm-modal" class="fixed inset-0 hidden items-center justify-center bg-black bg-opacity-50 transition-opacity" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="w-full max-w-md transform rounded-lg bg-white p-6 shadow-xl transition-all">
      <h2 class="text-xl font-bold text-gray-800" id="confirm-modal-title">Konfirmasi Tindakan</h2>
      <p class="my-4 text-gray-600" id="confirm-modal-text">
        Ini adalah tindakan berisiko. Untuk melanjutkan, ketik <strong class="text-red-600">CONFIRM</strong> di bawah ini.
      </p>
      <input type="text" id="confirm-modal-input" class="w-full rounded border p-2" placeholder="CONFIRM" autocomplete="off">
      <div class="mt-6 flex justify-end space-x-4">
        <button type="button" id="confirm-modal-cancel" class="rounded bg-gray-200 px-4 py-2 font-bold text-gray-700 hover:bg-gray-300">
          Batal
        </button>
        <button type="button" id="confirm-modal-ok" class="rounded bg-red-600 px-4 py-2 font-bold text-white transition hover:bg-red-700 disabled:cursor-not-allowed disabled:opacity-50" disabled>
          Konfirmasi
        </button>
      </div>
    </div>
  </div>

  <footer class="bg-white/60 backdrop-blur-lg border-t border-slate-200 text-slate-700 py-6 mt-auto">
    <div class="max-w-6xl mx-auto flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 px-6 text-sm">

      <div class="flex flex-col">
        <h2 class="text-xl font-semibold text-slate-900 mb-1">LigaPass</h2>
        <div class="flex flex-wrap items-center gap-4 text-slate-600">
          <a href="mailto:liga.pass@outlook.com" class="flex items-center gap-2 hover:text-blue-600 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l9 6 9-6M4 6h16a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2z" />
            </svg>
            liga.pass@outlook.com
          </a>

          <span class="text-slate-400">•</span>

          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 11c1.657 0 3-1.343 3-3S13.657 5 12 5s-3 1.343-3 3 1.343 3 3 3z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 22s8-4.5 8-11a8 8 0 10-16 0c0 6.5 8 11 8 11z" />
            </svg>
            Depok, West Java
          </div>
        </div>
      </div>

      <p class="text-slate-500 text-center sm:text-right mt-2 sm:mt-0">
        © 2025 LigaPass. All rights reserved.
      </p>

    </div>
  </footer>

  {% block scripts %}
    <script src="{% static 'js/toast.js' %}"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const logoutForm = document.getElementById('logoutForm');

      if (logoutForm) {
        logoutForm.addEventListener('submit', function(event) {
          event.preventDefault();

          const form = event.target;
          const url = form.action;
          const formData = new FormData(form);
          const csrfToken = formData.get('csrfmiddlewaretoken');
          fetch(url, {
            method: 'POST',
            headers: {
              'X-CSRFToken': csrfToken,
              'X-Requested-With': 'XMLHttpRequest'
            },
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Logout request failed');
            }
            return response.json();
          })
          .then(data => {
            if (data.status === 'success') {
              showToast(data.message || "Logout successful", "success");
              setTimeout(() => window.location.href = data.redirect_url, 800);
            } else {
              showToast(data.message || "Logout failed", "error");
            }
          })
                    .catch(error => {
            console.error('Logout error:', error);
            alert('An error occurred during logout. Please try again.');
          });
        });
      }

      const modal = document.getElementById('confirm-modal');
      if (modal) {
          const modalTitle = document.getElementById('confirm-modal-title');
          const modalText = document.getElementById('confirm-modal-text');
          const modalInput = document.getElementById('confirm-modal-input');
          const modalOk = document.getElementById('confirm-modal-ok');
          const modalCancel = document.getElementById('confirm-modal-cancel');
          
          let globalOnConfirmCallback = null;

          window.showConfirmationModal = function(title, text, onConfirm) {
              modalTitle.textContent = title;
              modalText.innerHTML = text; 
              globalOnConfirmCallback = onConfirm;
              
              modalInput.value = '';
              modalOk.disabled = true;
              modal.classList.remove('hidden');
              modal.classList.add('flex');
              modalInput.focus();
          }

          function hideModal() {
              modal.classList.add('hidden');
              modal.classList.remove('flex');
              globalOnConfirmCallback = null;
          }

          modalInput.addEventListener('input', function() {
              if (modalInput.value === 'CONFIRM') {
                  modalOk.disabled = false;
              } else {
                  modalOk.disabled = true;
              }
          });

          modalCancel.addEventListener('click', hideModal);

          modalOk.addEventListener('click', function() {
              if (modalInput.value === 'CONFIRM' && globalOnConfirmCallback) {
                  globalOnConfirmCallback();
              }
              hideModal();
          });
      }
    });
  </script>
{% endblock %}
</body>
</html>