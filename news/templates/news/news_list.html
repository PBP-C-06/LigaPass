{% extends "base.html" %}
{% block title %}Daftar Berita - LigaPass{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">Daftar Berita</h1>

<form method="get" class="mb-6 flex flex-wrap gap-4 items-center">

  <!-- Search Input -->
  <input type="text" name="search" placeholder="Cari judul..." class="px-4 py-2 border rounded-md" value="{{ request.GET.search }}">

  <!-- Category Dropdown -->
  <div class="relative">
    <select name="category" class="block appearance-none px-4 py-2 border rounded-md bg-white pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
      <option value="">Semua Kategori</option>
      {% for key, label in category_choices %}
        <option value="{{ key }}" {% if request.GET.category == key %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600">
      <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>

  <!-- Featured Dropdown -->
  <div class="relative">
    <select name="is_featured" class="block appearance-none px-4 py-2 border rounded-md bg-white pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
      <option value="">Semua</option>
      <option value="true" {% if request.GET.is_featured == 'true' %}selected{% endif %}>Featured</option>
      <option value="false" {% if request.GET.is_featured == 'false' %}selected{% endif %}>Biasa</option>
    </select>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600">
      <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>

  <!-- Sort Dropdown -->
  <div class="relative">
    <select name="sort" class="block appearance-none px-4 py-2 border rounded-md bg-white pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
      <option value="created_at" {% if request.GET.sort == "created_at" %}selected{% endif %}>Terbaru</option>
      <option value="edited_at" {% if request.GET.sort == "edited_at" %}selected{% endif %}>Terakhir Diedit</option>
      <option value="news_views" {% if request.GET.sort == "news_views" %}selected{% endif %}>Populer</option>
    </select>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600">
      <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </div>
  </div>

  <!-- Submit Button -->
  <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
    Filter
  </button>
</form>

{% if request.user.is_authenticated and request.user.role == 'journalist' %}
  <div class="mb-6">
    <a href="{% url 'news:news_create' %}" class="inline-block bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded">
      + Tambah News
    </a>
  </div>
{% endif %}

<ul class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
  {% for item in news_list %}
    {% include 'news/news_card.html' with news=item %}
  {% empty %}
    <li class="text-gray-500">Tidak ada berita ditemukan.</li>
  {% endfor %}
</ul>
{% endblock %}